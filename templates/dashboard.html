{% extends "base.html" %}

{% block title %}Dashboard - Project Manager{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h1>Dashboard</h1>
        <p class="text-muted">Welcome back, {{ current_user.username }}!</p>
    </div>
</div>

<!-- Statistics Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card bg-primary text-white">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-folder"></i> Programs</h5>
                <h2>{{ stats.programs }}</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success text-white">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-briefcase"></i> Projects</h5>
                <h2>{{ stats.projects }}</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-info text-white">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-check-square"></i> Tasks</h5>
                <h2>{{ stats.tasks }}</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-warning text-white">
            <div class="card-body">
                <h5 class="card-title"><i class="bi bi-people"></i> Contacts</h5>
                <h2>{{ stats.contacts }}</h2>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mb-4">
    <div class="col">
        <h3>Quick Actions</h3>
        <div class="btn-group" role="group">
            <a href="{{ url_for('new_program') }}" class="btn btn-primary">
                <i class="bi bi-plus-circle"></i> New Program
            </a>
            <a href="{{ url_for('new_project') }}" class="btn btn-success">
                <i class="bi bi-plus-circle"></i> New Project
            </a>
            <a href="{{ url_for('new_contact') }}" class="btn btn-warning">
                <i class="bi bi-plus-circle"></i> New Contact
            </a>
        </div>
    </div>
</div>

<!-- Recent Programs -->
{% if programs %}
<div class="row mb-4">
    <div class="col">
        <h3>Recent Programs</h3>
        <div class="list-group">
            {% for program in programs[:5] %}
            <a href="{{ url_for('view_program', program_id=program.id) }}" class="list-group-item list-group-item-action">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1"><i class="bi bi-folder"></i> {{ program.name }}</h5>
                    <small>
                        <span class="badge bg-secondary">{{ program.status }}</span>
                        <span class="badge bg-info">{{ program.projects|length }} projects</span>
                    </small>
                </div>
                {% if program.description %}
                <p class="mb-1">{{ program.description[:100] }}{% if program.description|length > 100 %}...{% endif %}</p>
                {% endif %}
                <small class="text-muted">
                    {% if program.start_date %}Start: {{ program.start_date }}{% endif %}
                    {% if program.end_date %} | End: {{ program.end_date }}{% endif %}
                </small>
            </a>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- Standalone Projects -->
{% if standalone_projects %}
<div class="row mb-4">
    <div class="col">
        <h3>Standalone Projects</h3>
        <div class="list-group">
            {% for project in standalone_projects[:5] %}
            <a href="{{ url_for('view_project', project_id=project.id) }}" class="list-group-item list-group-item-action">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1"><i class="bi bi-briefcase"></i> {{ project.name }}</h5>
                    <small>
                        <span class="badge bg-secondary">{{ project.status }}</span>
                        <span class="badge bg-info">{{ project.tasks|length }} tasks</span>
                    </small>
                </div>
                {% if project.description %}
                <p class="mb-1">{{ project.description[:100] }}{% if project.description|length > 100 %}...{% endif %}</p>
                {% endif %}
                <small class="text-muted">
                    {% if project.start_date %}Start: {{ project.start_date }}{% endif %}
                    {% if project.end_date %} | End: {{ project.end_date }}{% endif %}
                </small>
            </a>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

{% if not programs and not standalone_projects %}
<div class="row">
    <div class="col text-center py-5">
        <i class="bi bi-inbox" style="font-size: 4rem; color: #ccc;"></i>
        <h3 class="mt-3">No Programs or Projects Yet</h3>
        <p class="text-muted">Get started by creating your first program or project!</p>
        <a href="{{ url_for('new_program') }}" class="btn btn-primary me-2">Create Program</a>
        <a href="{{ url_for('new_project') }}" class="btn btn-success">Create Project</a>
    </div>
</div>
{% endif %}
{% endblock %}
